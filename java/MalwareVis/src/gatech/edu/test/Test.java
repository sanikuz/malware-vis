package gatech.edu.test;

import gatech.edu.pcap.DNSStream;
import gatech.edu.pcap.Stream;
import gatech.edu.pcap.TCPStream;
import java.util.ArrayList;

public class Test {

	private static void parse_stream(Stream stream){
		long numPackets = stream.getNumPackets();
		double starttime = stream.getStartTime();
		double endtime = stream.getEndTime();
		double size = stream.getSize();
		boolean finished = stream.getFinished();
		boolean successful = stream.getSuccessful();
		System.out.println("no of pack: "+numPackets+" starttime: "+starttime
				+"\nend time: "+endtime+" size: "+size
				+"\nfinished: "+finished+" successful: "+successful);
	}
	
	private static void parse_dnsstream(DNSStream stream){
		String domainname = stream.getDomainName();
		ArrayList<String> ips = stream.getIPs();
		System.out.println("Domain name: "+domainname);
		System.out.println(ips);
	}
	
	private static void parse_tcpstream(TCPStream stream){
		String srcIP = stream.getSrcIP();
		String dstIP = stream.getDstIP();
		System.out.println("SrcIP: "+srcIP+" DstIP: "+dstIP);
	}
	
	private static void parse_pcap_streams(ArrayList<Stream> streams){
		for(Stream stream:streams){
			parse_stream(stream);
			if(stream instanceof DNSStream){
				DNSStream dnsstream = (DNSStream)stream;
				parse_dnsstream(dnsstream);
			} else if(stream instanceof TCPStream){
				TCPStream tcpstream = (TCPStream)stream;
				parse_tcpstream(tcpstream);
			}
		}
	}
	
}