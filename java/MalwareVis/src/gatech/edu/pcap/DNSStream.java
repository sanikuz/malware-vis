package gatech.edu.pcap;
import java.util.ArrayList;
public class DNSStream extends Stream {

  private String domainName;
  private ArrayList<String> ips;
  
  public DNSStream(){
	  super(); 
  }
  public DNSStream(long numPackets, long size, double startTime, double endTime,
      boolean finished, boolean successful, String domainName, ArrayList<String> ips) {
      super(numPackets, size, startTime, endTime, finished, successful);
      this.domainName = domainName;
      this.ips = ips;
  }

  public String getDomainName() {
      return domainName;
  }

  public ArrayList<String> getIPs() {
    return ips;
  }

  @Override
public String toString() {
    return "DNS,"+this.domainName+":"+ super.toString();
  }
  public void parse(String line){
	  String[] token = line.split(":"); 
	  if (token.length!=2) {System.out.println("invalid input!"); return;}
	  String[] part = token[0].split(",");
	  if (part.length!=2) {System.out.println("invalid input!"); return;}
	  this.domainName = part[1]; 
	  super.parseString(token[1]); 
  }
}
